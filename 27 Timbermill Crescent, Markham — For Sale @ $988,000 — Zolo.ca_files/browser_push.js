function sendSubscriptionToServer(a){var b=a.endpoint.split("/"),c=b[b.length-1];console.log(c),document.cookie="id-bpuuid="+c+"; expires=Fri, 31 Dec 2100 12:00:00 UTC; path=/";var d="./browser_app_json.php",e=new XMLHttpRequest;e.onreadystatechange=function(){return 4==e.readyState&&200==e.status?"accepted":"denied"},e.open("POST",d,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send("bpuuid="+c)}function subscribe(){navigator.serviceWorker.ready.then(function(a){a.pushManager.subscribe({userVisibleOnly:!0}).then(function(a){return isPushEnabled=!0,sendSubscriptionToServer(a)}).catch(function(a){"denied"===Notification.permission?console.warn("Permission for Notifications was denied"):console.error("Unable to subscribe to push.",a)})})}function unsubscribe(){navigator.serviceWorker.ready.then(function(a){a.pushManager.getSubscription().then(function(a){if(!a)return void(isPushEnabled=!1);a.subscriptionId;a.unsubscribe().then(function(a){isPushEnabled=!1}).catch(function(a){console.log("Unsubscription error: ",a)})}).catch(function(a){console.error("Error thrown while unsubscribing from push messaging.",a)})})}function initialiseState(){return"showNotification"in ServiceWorkerRegistration.prototype?"PushManager"in window?void navigator.serviceWorker.ready.then(function(a){a.pushManager.getSubscription().then(function(a){a?isPushEnabled=!0:subscribe()})}):void console.warn("Push messaging isn't supported."):void console.warn("Notifications aren't supported.")}var isPushEnabled=!1;window.addEventListener("load",function(){"serviceWorker"in navigator?navigator.serviceWorker.register("https://www.zolo.ca/service-worker.js",{scope:"/"}).then(initialiseState).catch(function(a){console.log("Browser notification registration failed: ")}):console.warn("Service workers aren't supported in this browser.")});